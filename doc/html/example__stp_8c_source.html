<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>OpenNSL API Guide and Reference Manual: examples/example_stp.c Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen/doxygen_brcm.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">OpenNSL API Guide and Reference Manual
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Welcome</span></a></li>
      <li><a href="pages.html"><span>OpenNSL&#160;Documentation</span></a></li>
      <li><a href="modules.html"><span>API&#160;Reference</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">examples/example_stp.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="example__stp_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*********************************************************************</span>
<a name="l00002"></a>00002 <span class="comment"> *</span>
<a name="l00003"></a>00003 <span class="comment"> * (C) Copyright Broadcom Corporation 2013-2015</span>
<a name="l00004"></a>00004 <span class="comment"> *</span>
<a name="l00005"></a>00005 <span class="comment"> *  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<a name="l00006"></a>00006 <span class="comment"> *  you may not use this file except in compliance with the License.</span>
<a name="l00007"></a>00007 <span class="comment"> *  You may obtain a copy of the License at</span>
<a name="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009"></a>00009 <span class="comment"> *      http://www.apache.org/licenses/LICENSE-2.0</span>
<a name="l00010"></a>00010 <span class="comment"> *</span>
<a name="l00011"></a>00011 <span class="comment"> *  Unless required by applicable law or agreed to in writing, software</span>
<a name="l00012"></a>00012 <span class="comment"> *  distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<a name="l00013"></a>00013 <span class="comment"> *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<a name="l00014"></a>00014 <span class="comment"> *  See the License for the specific language governing permissions and</span>
<a name="l00015"></a>00015 <span class="comment"> *  limitations under the License.</span>
<a name="l00016"></a>00016 <span class="comment"> *</span>
<a name="l00017"></a>00017 <span class="comment"> **********************************************************************</span>
<a name="l00018"></a>00018 <span class="comment"> *</span>
<a name="l00019"></a>00019 <span class="comment"> * \file         example_stp.c</span>
<a name="l00020"></a>00020 <span class="comment"> *</span>
<a name="l00021"></a>00021 <span class="comment"> * \brief        OPENNSL example program to demonstrate Spanning Tree</span>
<a name="l00022"></a>00022 <span class="comment"> *               application.</span>
<a name="l00023"></a>00023 <span class="comment"> *</span>
<a name="l00024"></a>00024 <span class="comment"> * \details      This example demonstrates on how to remove a loop by</span>
<a name="l00025"></a>00025 <span class="comment"> *               modifying the spanning tree state of a port.</span>
<a name="l00026"></a>00026 <span class="comment"> *</span>
<a name="l00027"></a>00027 <span class="comment"> *</span>
<a name="l00028"></a>00028 <span class="comment"> **********************************************************************/</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;<a class="code" href="driver_8h.html">sal/driver.h</a>&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;<a class="code" href="opennsl_2types_8h.html">opennsl/types.h</a>&gt;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;<a class="code" href="opennsl_2port_8h.html">opennsl/port.h</a>&gt;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;<a class="code" href="vlan_8h.html">opennsl/vlan.h</a>&gt;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;<a class="code" href="opennsl_2error_8h.html">opennsl/error.h</a>&gt;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &lt;<a class="code" href="stg_8h.html">opennsl/stg.h</a>&gt;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &lt;<a class="code" href="examples_2util_8h.html">examples/util.h</a>&gt;</span>
<a name="l00039"></a>00039 
<a name="l00040"></a><a class="code" href="example__stp_8c.html#afc7d01e6dbea2c820a68fb8081c58a89">00040</a> <span class="keywordtype">char</span> <a class="code" href="example__bst_8c.html#afc7d01e6dbea2c820a68fb8081c58a89">example_usage</a>[] =
<a name="l00041"></a>00041 <span class="stringliteral">&quot;Syntax: example_stp                                                    \n\r&quot;</span>
<a name="l00042"></a>00042 <span class="stringliteral">&quot;                                                                       \n\r&quot;</span>
<a name="l00043"></a>00043 <span class="stringliteral">&quot;Paramaters:                                                            \n\r&quot;</span>
<a name="l00044"></a>00044 <span class="stringliteral">&quot;       port1  - First port number.                                     \n\r&quot;</span>
<a name="l00045"></a>00045 <span class="stringliteral">&quot;       port2  - Second port number.                                    \n\r&quot;</span>
<a name="l00046"></a>00046 <span class="stringliteral">&quot;                                                                       \n\r&quot;</span>
<a name="l00047"></a>00047 <span class="stringliteral">&quot;Example: The following command is used to demonstrate on how to remove \n\r&quot;</span>
<a name="l00048"></a>00048 <span class="stringliteral">&quot;         loop by modifying the spanning tree state of a port.          \n\r&quot;</span>
<a name="l00049"></a>00049 <span class="stringliteral">&quot;         example_stp 5 6                                               \n\r&quot;</span>
<a name="l00050"></a>00050 <span class="stringliteral">&quot;                                                                       \n\r&quot;</span>
<a name="l00051"></a>00051 <span class="stringliteral">&quot;Usage Guidelines: This program takes two ports numbers as input and    \n\r&quot;</span>
<a name="l00052"></a>00052 <span class="stringliteral">&quot;       place them in VLAN 100 and by default put them in forwarding    \n\r&quot;</span>
<a name="l00053"></a>00053 <span class="stringliteral">&quot;       state. This results in a loop if both the ports are connected   \n\r&quot;</span>
<a name="l00054"></a>00054 <span class="stringliteral">&quot;       to a partner switch. Here the program provides the menu with    \n\r&quot;</span>
<a name="l00055"></a>00055 <span class="stringliteral">&quot;       the following options.                                          \n\r&quot;</span>
<a name="l00056"></a>00056 <span class="stringliteral">&quot;                                                                       \n\r&quot;</span>
<a name="l00057"></a>00057 <span class="stringliteral">&quot;       1) Configure the STP state of a port.                           \n\r&quot;</span>
<a name="l00058"></a>00058 <span class="stringliteral">&quot;       2) Display the STP state of ports.                              \n\r&quot;</span>
<a name="l00059"></a>00059 <span class="stringliteral">&quot;       3) Quit the application.                                        \n\r&quot;</span>
<a name="l00060"></a>00060 <span class="stringliteral">&quot;                                                                       \n\r&quot;</span>;
<a name="l00061"></a>00061 
<a name="l00062"></a>00062 
<a name="l00063"></a><a class="code" href="example__stp_8c.html#adbb76aecfc5eef000cb4cb55bc2fd404">00063</a> <span class="preprocessor">#define DEFAULT_UNIT         0</span>
<a name="l00064"></a><a class="code" href="example__stp_8c.html#a80eff068cbb65277bdcfcd678d4b593d">00064</a> <span class="preprocessor"></span><span class="preprocessor">#define VLANID               100</span>
<a name="l00065"></a><a class="code" href="example__stp_8c.html#a068278b0838b6670ab0ab0a93ed77484">00065</a> <span class="preprocessor"></span><span class="preprocessor">#define MAX_DIGITS_IN_CHOICE 5</span>
<a name="l00066"></a>00066 <span class="preprocessor"></span>
<a name="l00067"></a><a class="code" href="structstg__info__s.html">00067</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00068"></a><a class="code" href="structstg__info__s.html#a8ce9eaa586377944527b3a36d1193e63">00068</a>   <span class="keywordtype">int</span> <a class="code" href="structstg__info__s.html#a8ce9eaa586377944527b3a36d1193e63">vlan_1</a>;
<a name="l00069"></a><a class="code" href="structstg__info__s.html#a6cc6a444e17b7a95da3b47b901999ac0">00069</a>   <span class="keywordtype">int</span> <a class="code" href="structstg__info__s.html#a6cc6a444e17b7a95da3b47b901999ac0">port_1</a>;
<a name="l00070"></a><a class="code" href="structstg__info__s.html#addd1bd50cfb8cee2b63c34cbf4ef3582">00070</a>   <span class="keywordtype">int</span> <a class="code" href="structstg__info__s.html#addd1bd50cfb8cee2b63c34cbf4ef3582">port_2</a>;
<a name="l00071"></a><a class="code" href="structstg__info__s.html#a732dc92a708481c8aa6266d71771c7da">00071</a>   <span class="keywordtype">int</span> <a class="code" href="structstg__info__s.html#a732dc92a708481c8aa6266d71771c7da">stp_state_1</a>;
<a name="l00072"></a><a class="code" href="structstg__info__s.html#a5bf712990d2edd0345bbdb18a0e58044">00072</a>   <span class="keywordtype">int</span> <a class="code" href="structstg__info__s.html#a5bf712990d2edd0345bbdb18a0e58044">stp_state_2</a>;
<a name="l00073"></a><a class="code" href="structstg__info__s.html#a9e2acb72995a5779237c8b66f3904a53">00073</a>   <a class="code" href="group__types.html#gad111ca9d6deb73308b07bc0b4d761b17" title="opennsl_stg_t">opennsl_stg_t</a> <a class="code" href="structstg__info__s.html#a9e2acb72995a5779237c8b66f3904a53">stg</a>;
<a name="l00074"></a>00074 } <a class="code" href="structstg__info__s.html">stg_info_s</a>;
<a name="l00075"></a>00075 <span class="comment">/* __doxy_func_body_end__ */</span>
<a name="l00076"></a>00076 
<a name="l00077"></a><a class="code" href="example__stp_8c.html#ae0e347ac4536e36380f2a6b66bed71f4">00077</a> <span class="keywordtype">char</span> *<a class="code" href="example__stp_8c.html#ae0e347ac4536e36380f2a6b66bed71f4">stp_state_str</a>[] =
<a name="l00078"></a>00078 {
<a name="l00079"></a>00079   <span class="stringliteral">&quot;Disable&quot;</span>, <span class="comment">/* OPENNSL_STG_STP_DISABLE */</span>
<a name="l00080"></a>00080   <span class="stringliteral">&quot;Block&quot;</span>,   <span class="comment">/* OPENNSL_STG_STP_BLOCK   */</span>
<a name="l00081"></a>00081   <span class="stringliteral">&quot;Listen&quot;</span>,  <span class="comment">/* OPENNSL_STG_STP_LISTEN  */</span>
<a name="l00082"></a>00082   <span class="stringliteral">&quot;Learn&quot;</span>,   <span class="comment">/* OPENNSL_STG_STP_LEARN   */</span>
<a name="l00083"></a>00083   <span class="stringliteral">&quot;Forward&quot;</span>  <span class="comment">/* OPENNSL_STG_STP_FORWARD */</span>
<a name="l00084"></a>00084 };
<a name="l00085"></a>00085 <span class="comment">/* __doxy_func_body_end__ */</span>
<a name="l00086"></a>00086 
<a name="l00087"></a>00087 <span class="comment">/* debug prints */</span>
<a name="l00088"></a><a class="code" href="example__stp_8c.html#a0b2caeb4b6f130be43e5a2f0267dd453">00088</a> <span class="keywordtype">int</span> <a class="code" href="example__routing_8c.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a> = 3;
<a name="l00089"></a>00089 
<a name="l00090"></a><a class="code" href="example__stp_8c.html#ad148af3cd81733fec0a4eb2b7bee1071">00090</a> <span class="preprocessor">#define CALL_IF_ERROR_RETURN(op)                            \</span>
<a name="l00091"></a>00091 <span class="preprocessor">  do {                                                      \</span>
<a name="l00092"></a>00092 <span class="preprocessor">    int __rv__;                                             \</span>
<a name="l00093"></a>00093 <span class="preprocessor">    if ((__rv__ = (op)) &lt; 0) {                              \</span>
<a name="l00094"></a>00094 <span class="preprocessor">      printf(&quot;%s:%s: line %d rv: %d failed: %s\n&quot;,          \</span>
<a name="l00095"></a>00095 <span class="preprocessor">          __FILE__, __FUNCTION__, __LINE__, __rv__,         \</span>
<a name="l00096"></a>00096 <span class="preprocessor">          opennsl_errmsg(__rv__));                          \</span>
<a name="l00097"></a>00097 <span class="preprocessor">    }                                                       \</span>
<a name="l00098"></a>00098 <span class="preprocessor">  } while(0)</span>
<a name="l00099"></a>00099 <span class="preprocessor"></span><span class="comment">/* __doxy_func_body_end__ */</span>
<a name="l00100"></a>00100 
<a name="l00101"></a>00101 
<a name="l00102"></a>00102 <span class="comment">/* Declarations below */</span>
<a name="l00103"></a>00103 <span class="keywordtype">int</span> <a class="code" href="example__stp_8c.html#a2033163d18300d10dfb751120e4a0029" title="Initialization routine to create spanning tree instance and initialize the structures.">example_stg_init</a>(<span class="keywordtype">int</span> unit, <a class="code" href="structstg__info__s.html">stg_info_s</a> *info, <span class="keywordtype">int</span> port1, <span class="keywordtype">int</span> port2);
<a name="l00104"></a>00104 <span class="keywordtype">int</span> <a class="code" href="example__stp_8c.html#af4e9d5c2526280fcdd0327946b5a303d" title="To add a given set of ports and VLAN to spanning tree instance.">example_stg_create</a>(<span class="keywordtype">int</span> unit, <a class="code" href="structstg__info__s.html">stg_info_s</a> *info);
<a name="l00105"></a>00105 
<a name="l00106"></a>00106 <span class="comment">/**********************************************************************/</span>
<a name="l00113"></a><a class="code" href="example__stp_8c.html#a0ddf1224851353fc92bfbff6f499fa97">00113</a> <span class="keywordtype">int</span> <a class="code" href="example__bst_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function for bst sample application.">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])
<a name="l00114"></a>00114 {
<a name="l00115"></a>00115   <span class="keywordtype">int</span> rv = <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>;
<a name="l00116"></a>00116   <span class="keywordtype">int</span> unit = <a class="code" href="example__stp_8c.html#adbb76aecfc5eef000cb4cb55bc2fd404">DEFAULT_UNIT</a>;
<a name="l00117"></a>00117   <span class="keywordtype">int</span> port1;
<a name="l00118"></a>00118   <span class="keywordtype">int</span> port2;
<a name="l00119"></a>00119   <span class="keywordtype">int</span> port;
<a name="l00120"></a>00120   <span class="keywordtype">int</span> stp_mode;
<a name="l00121"></a>00121   <span class="keywordtype">int</span> stp_state;
<a name="l00122"></a>00122   <span class="keywordtype">int</span> choice;
<a name="l00123"></a>00123   <a class="code" href="structstg__info__s.html">stg_info_s</a> info;
<a name="l00124"></a>00124 
<a name="l00125"></a>00125 
<a name="l00126"></a>00126   <span class="keywordflow">if</span>((argc != 3) || ((argc &gt; 1) &amp;&amp; (strcmp(argv[1], <span class="stringliteral">&quot;--help&quot;</span>) == 0))) {
<a name="l00127"></a>00127     printf(<span class="stringliteral">&quot;%s\n\r&quot;</span>, <a class="code" href="example__bst_8c.html#afc7d01e6dbea2c820a68fb8081c58a89">example_usage</a>);
<a name="l00128"></a>00128     <span class="keywordflow">return</span> <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a8b380efdb47b4a4b0ebafbb1c7823748">OPENNSL_E_PARAM</a>;
<a name="l00129"></a>00129   }
<a name="l00130"></a>00130 
<a name="l00131"></a>00131   <span class="comment">/* Initialize the system */</span>
<a name="l00132"></a>00132   rv = <a class="code" href="driver_8h.html#a1c3e46e06d91a45608e9839952c60ff2">opennsl_driver_init</a>();
<a name="l00133"></a>00133 
<a name="l00134"></a>00134   <span class="keywordflow">if</span>(rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {
<a name="l00135"></a>00135     printf(<span class="stringliteral">&quot;\r\nFailed to initialize the system.\r\n&quot;</span>);
<a name="l00136"></a>00136     <span class="keywordflow">return</span> rv;
<a name="l00137"></a>00137   }
<a name="l00138"></a>00138 
<a name="l00139"></a>00139   <span class="comment">/* Extract inputs parameters */</span>
<a name="l00140"></a>00140   port1 = atoi(argv[1]);
<a name="l00141"></a>00141   port2 = atoi(argv[2]);
<a name="l00142"></a>00142 
<a name="l00143"></a>00143   <span class="comment">/* Call the STP action routines */</span>
<a name="l00144"></a>00144   <a class="code" href="example__stp_8c.html#ad148af3cd81733fec0a4eb2b7bee1071">CALL_IF_ERROR_RETURN</a>(<a class="code" href="example__stp_8c.html#a2033163d18300d10dfb751120e4a0029" title="Initialization routine to create spanning tree instance and initialize the structures.">example_stg_init</a>(unit, &amp;info, port1, port2));
<a name="l00145"></a>00145   <a class="code" href="example__stp_8c.html#ad148af3cd81733fec0a4eb2b7bee1071">CALL_IF_ERROR_RETURN</a>(<a class="code" href="example__stp_8c.html#af4e9d5c2526280fcdd0327946b5a303d" title="To add a given set of ports and VLAN to spanning tree instance.">example_stg_create</a>(unit, &amp;info));
<a name="l00146"></a>00146 
<a name="l00147"></a>00147   <span class="comment">/* Display the interactive user menu */</span>
<a name="l00148"></a>00148   <span class="keywordflow">while</span>(1)
<a name="l00149"></a>00149   {
<a name="l00150"></a>00150     printf(<span class="stringliteral">&quot;Interactive User Menu:\n&quot;</span>);
<a name="l00151"></a>00151     printf(<span class="stringliteral">&quot;1. Configure STP state of a port\n&quot;</span>);
<a name="l00152"></a>00152     printf(<span class="stringliteral">&quot;2. Display the STP state of ports\n&quot;</span>);
<a name="l00153"></a>00153 <span class="preprocessor">#ifndef CDP_EXCLUDE</span>
<a name="l00154"></a>00154 <span class="preprocessor"></span>    printf(<span class="stringliteral">&quot;9. Launch diagnostic shell\n&quot;</span>);
<a name="l00155"></a>00155 <span class="preprocessor">#endif</span>
<a name="l00156"></a>00156 <span class="preprocessor"></span>    printf(<span class="stringliteral">&quot;0. Quit the application\n&quot;</span>);
<a name="l00157"></a>00157 
<a name="l00158"></a>00158    <span class="keywordflow">if</span>(<a class="code" href="examples_2util_8h.html#ad0173c952d5a8af01c14eebabc05b5df" title="Read numeric menu choice from user.">example_read_user_choice</a>(&amp;choice) != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)
<a name="l00159"></a>00159    {
<a name="l00160"></a>00160        printf(<span class="stringliteral">&quot;Invalid option entered. Please re-enter.\n&quot;</span>);
<a name="l00161"></a>00161        <span class="keywordflow">continue</span>;
<a name="l00162"></a>00162     }
<a name="l00163"></a>00163 
<a name="l00164"></a>00164     <span class="keywordflow">switch</span>(choice)
<a name="l00165"></a>00165     {
<a name="l00166"></a>00166       <span class="keywordflow">case</span> 1:
<a name="l00167"></a>00167       {
<a name="l00168"></a>00168         printf(<span class="stringliteral">&quot;1. Enter port number\n&quot;</span>);
<a name="l00169"></a>00169         <span class="keywordflow">if</span>(<a class="code" href="examples_2util_8h.html#ad0173c952d5a8af01c14eebabc05b5df" title="Read numeric menu choice from user.">example_read_user_choice</a>(&amp;port) != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)
<a name="l00170"></a>00170         {
<a name="l00171"></a>00171             printf(<span class="stringliteral">&quot;Invalid option entered. Please re-enter.\n&quot;</span>);
<a name="l00172"></a>00172             <span class="keywordflow">continue</span>;
<a name="l00173"></a>00173         }
<a name="l00174"></a>00174         printf(<span class="stringliteral">&quot;1. Enter STP state of the port\n&quot;</span>);
<a name="l00175"></a>00175         printf(<span class="stringliteral">&quot;   STP state: 1 - Forward, 2 - Block\n&quot;</span>);
<a name="l00176"></a>00176         <span class="keywordflow">if</span>(<a class="code" href="examples_2util_8h.html#ad0173c952d5a8af01c14eebabc05b5df" title="Read numeric menu choice from user.">example_read_user_choice</a>(&amp;stp_mode) != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)
<a name="l00177"></a>00177         {
<a name="l00178"></a>00178             printf(<span class="stringliteral">&quot;Invalid option %d entered. Please re-enter.\n&quot;</span>, stp_mode);
<a name="l00179"></a>00179             <span class="keywordflow">continue</span>;
<a name="l00180"></a>00180         }
<a name="l00181"></a>00181 
<a name="l00182"></a>00182         <span class="keywordflow">if</span>(stp_mode == 1) {
<a name="l00183"></a>00183           stp_state = <a class="code" href="group__stg.html#gga9d59789af75382e059ed70a13fb4efe1adccd387496b817e57070e97510521094" title="Normal operation.">OPENNSL_STG_STP_FORWARD</a>;
<a name="l00184"></a>00184         } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(stp_mode == 2) {
<a name="l00185"></a>00185           stp_state = <a class="code" href="group__stg.html#gga9d59789af75382e059ed70a13fb4efe1a00f0f1cf9b23bbaa53041d7e114c43f4" title="BPDUs/no learns.">OPENNSL_STG_STP_BLOCK</a>;
<a name="l00186"></a>00186         }
<a name="l00187"></a>00187         <span class="keywordflow">else</span> {
<a name="l00188"></a>00188           printf(<span class="stringliteral">&quot;Invalid option is entered. Please re-enter.\n&quot;</span>);
<a name="l00189"></a>00189           <span class="keywordflow">continue</span>;
<a name="l00190"></a>00190         }
<a name="l00191"></a>00191 
<a name="l00192"></a>00192         rv = <a class="code" href="group__stg.html#gac4824e77e2d0cd577a9962d63e5b53ac" title="Set the Spanning Tree Protocol state of a port in the specified STG.">opennsl_stg_stp_set</a>(unit, info.<a class="code" href="structstg__info__s.html#a9e2acb72995a5779237c8b66f3904a53">stg</a>, port, stp_state);
<a name="l00193"></a>00193         <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {
<a name="l00194"></a>00194           printf(<span class="stringliteral">&quot;Failed to set STP state of port %d to &quot;</span>
<a name="l00195"></a>00195               <span class="stringliteral">&quot;\&quot;%s\&quot; in STG %d, \n&quot;</span>,
<a name="l00196"></a>00196               port, <a class="code" href="example__stp_8c.html#ae0e347ac4536e36380f2a6b66bed71f4">stp_state_str</a>[stp_state], info.<a class="code" href="structstg__info__s.html#a9e2acb72995a5779237c8b66f3904a53">stg</a>);
<a name="l00197"></a>00197           <span class="keywordflow">return</span> rv;
<a name="l00198"></a>00198         }
<a name="l00199"></a>00199         <span class="keywordflow">if</span>(<a class="code" href="example__routing_8c.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a> &gt;= 2) {
<a name="l00200"></a>00200           printf(<span class="stringliteral">&quot;STP state of port %d is set to \&quot;%s\&quot;.\n&quot;</span>,
<a name="l00201"></a>00201               port, <a class="code" href="example__stp_8c.html#ae0e347ac4536e36380f2a6b66bed71f4">stp_state_str</a>[stp_state]);
<a name="l00202"></a>00202         }
<a name="l00203"></a>00203         <span class="keywordflow">break</span>;
<a name="l00204"></a>00204       }
<a name="l00205"></a>00205       <span class="keywordflow">case</span> 2:
<a name="l00206"></a>00206       {
<a name="l00207"></a>00207         rv = <a class="code" href="group__stg.html#gad8ff9d87107967336829219b02d1ec3f" title="Return the Spanning Tree Protocol state of a port in the specified STG.">opennsl_stg_stp_get</a>(unit, info.<a class="code" href="structstg__info__s.html#a9e2acb72995a5779237c8b66f3904a53">stg</a>, info.<a class="code" href="structstg__info__s.html#a6cc6a444e17b7a95da3b47b901999ac0">port_1</a>, &amp;stp_state);
<a name="l00208"></a>00208         <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {
<a name="l00209"></a>00209           printf(<span class="stringliteral">&quot;Failed to get STP state of port %d in STG %d, \n&quot;</span>,
<a name="l00210"></a>00210               port, info.<a class="code" href="structstg__info__s.html#a9e2acb72995a5779237c8b66f3904a53">stg</a>);
<a name="l00211"></a>00211           <span class="keywordflow">return</span> rv;
<a name="l00212"></a>00212         }
<a name="l00213"></a>00213         printf(<span class="stringliteral">&quot;STP state of port %d is \&quot;%s\&quot; in STG %d.\n&quot;</span>,
<a name="l00214"></a>00214             info.<a class="code" href="structstg__info__s.html#a6cc6a444e17b7a95da3b47b901999ac0">port_1</a>, <a class="code" href="example__stp_8c.html#ae0e347ac4536e36380f2a6b66bed71f4">stp_state_str</a>[stp_state], info.<a class="code" href="structstg__info__s.html#a9e2acb72995a5779237c8b66f3904a53">stg</a>);
<a name="l00215"></a>00215 
<a name="l00216"></a>00216         rv = <a class="code" href="group__stg.html#gad8ff9d87107967336829219b02d1ec3f" title="Return the Spanning Tree Protocol state of a port in the specified STG.">opennsl_stg_stp_get</a>(unit, info.<a class="code" href="structstg__info__s.html#a9e2acb72995a5779237c8b66f3904a53">stg</a>, info.<a class="code" href="structstg__info__s.html#addd1bd50cfb8cee2b63c34cbf4ef3582">port_2</a>, &amp;stp_state);
<a name="l00217"></a>00217         <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {
<a name="l00218"></a>00218           printf(<span class="stringliteral">&quot;Failed to get STP state of port %d in STG %d, \n&quot;</span>,
<a name="l00219"></a>00219               info.<a class="code" href="structstg__info__s.html#addd1bd50cfb8cee2b63c34cbf4ef3582">port_2</a>, info.<a class="code" href="structstg__info__s.html#a9e2acb72995a5779237c8b66f3904a53">stg</a>);
<a name="l00220"></a>00220           <span class="keywordflow">return</span> rv;
<a name="l00221"></a>00221         }
<a name="l00222"></a>00222         printf(<span class="stringliteral">&quot;STP state of port %d is \&quot;%s\&quot; in STG %d.\n&quot;</span>,
<a name="l00223"></a>00223             info.<a class="code" href="structstg__info__s.html#addd1bd50cfb8cee2b63c34cbf4ef3582">port_2</a>, <a class="code" href="example__stp_8c.html#ae0e347ac4536e36380f2a6b66bed71f4">stp_state_str</a>[stp_state], info.<a class="code" href="structstg__info__s.html#a9e2acb72995a5779237c8b66f3904a53">stg</a>);
<a name="l00224"></a>00224         <span class="keywordflow">break</span>;
<a name="l00225"></a>00225       }
<a name="l00226"></a>00226 
<a name="l00227"></a>00227 <span class="preprocessor">#ifndef CDP_EXCLUDE</span>
<a name="l00228"></a>00228 <span class="preprocessor"></span>      <span class="keywordflow">case</span> 9:
<a name="l00229"></a>00229       {
<a name="l00230"></a>00230         <a class="code" href="driver_8h.html#a471900b16ad87718cd84e257ef98ca57">opennsl_driver_shell</a>();
<a name="l00231"></a>00231         <span class="keywordflow">break</span>;
<a name="l00232"></a>00232       }
<a name="l00233"></a>00233 <span class="preprocessor">#endif</span>
<a name="l00234"></a>00234 <span class="preprocessor"></span>
<a name="l00235"></a>00235       <span class="keywordflow">case</span> 0:
<a name="l00236"></a>00236       {
<a name="l00237"></a>00237         printf(<span class="stringliteral">&quot;User has requested to quit the application.\n&quot;</span>);
<a name="l00238"></a>00238         <span class="keywordflow">return</span> rv;
<a name="l00239"></a>00239         <span class="keywordflow">break</span>;
<a name="l00240"></a>00240       }
<a name="l00241"></a>00241       <span class="keywordflow">default</span>:
<a name="l00242"></a>00242         printf(<span class="stringliteral">&quot;Invalid option is entered. Please re-enter.\n&quot;</span>);
<a name="l00243"></a>00243 
<a name="l00244"></a>00244     } <span class="comment">/* End of switch */</span>
<a name="l00245"></a>00245 
<a name="l00246"></a>00246   } <span class="comment">/* End of while */</span>
<a name="l00247"></a>00247 
<a name="l00248"></a>00248 
<a name="l00249"></a>00249   <span class="keywordflow">return</span> rv;
<a name="l00250"></a>00250 }
<a name="l00251"></a>00251 <span class="comment">/* __doxy_func_body_end__ */</span>
<a name="l00252"></a>00252 
<a name="l00253"></a>00253 <span class="comment">/**************************************************************************/</span>
<a name="l00266"></a><a class="code" href="example__stp_8c.html#a2033163d18300d10dfb751120e4a0029">00266</a> <span class="keywordtype">int</span> <a class="code" href="example__stp_8c.html#a2033163d18300d10dfb751120e4a0029" title="Initialization routine to create spanning tree instance and initialize the structures.">example_stg_init</a>(<span class="keywordtype">int</span> unit, <a class="code" href="structstg__info__s.html">stg_info_s</a> *info, <span class="keywordtype">int</span> port1, <span class="keywordtype">int</span> port2) {
<a name="l00267"></a>00267   <span class="keywordtype">int</span> rv;
<a name="l00268"></a>00268 
<a name="l00269"></a>00269   info-&gt;<a class="code" href="structstg__info__s.html#a8ce9eaa586377944527b3a36d1193e63">vlan_1</a> = <a class="code" href="example__stp_8c.html#a80eff068cbb65277bdcfcd678d4b593d">VLANID</a>;
<a name="l00270"></a>00270   info-&gt;<a class="code" href="structstg__info__s.html#a6cc6a444e17b7a95da3b47b901999ac0">port_1</a> = port1;
<a name="l00271"></a>00271   info-&gt;<a class="code" href="structstg__info__s.html#addd1bd50cfb8cee2b63c34cbf4ef3582">port_2</a> = port2;
<a name="l00272"></a>00272   info-&gt;<a class="code" href="structstg__info__s.html#a732dc92a708481c8aa6266d71771c7da">stp_state_1</a> = <a class="code" href="group__stg.html#gga9d59789af75382e059ed70a13fb4efe1adccd387496b817e57070e97510521094" title="Normal operation.">OPENNSL_STG_STP_FORWARD</a>;
<a name="l00273"></a>00273   info-&gt;<a class="code" href="structstg__info__s.html#a5bf712990d2edd0345bbdb18a0e58044">stp_state_2</a> = <a class="code" href="group__stg.html#gga9d59789af75382e059ed70a13fb4efe1adccd387496b817e57070e97510521094" title="Normal operation.">OPENNSL_STG_STP_FORWARD</a>;
<a name="l00274"></a>00274   rv = <a class="code" href="group__stg.html#ga6bd8189c2f152a58e392a155415c675f" title="Create a new STG, using a new STG ID.">opennsl_stg_create</a>(unit,&amp;(info-&gt;<a class="code" href="structstg__info__s.html#a9e2acb72995a5779237c8b66f3904a53">stg</a>));
<a name="l00275"></a>00275   <span class="keywordflow">return</span> rv;
<a name="l00276"></a>00276 }
<a name="l00277"></a>00277 <span class="comment">/* __doxy_func_body_end__ */</span>
<a name="l00278"></a>00278 
<a name="l00279"></a>00279 <span class="comment">/**************************************************************************/</span>
<a name="l00288"></a><a class="code" href="example__stp_8c.html#af4e9d5c2526280fcdd0327946b5a303d">00288</a> <span class="keywordtype">int</span> <a class="code" href="example__stp_8c.html#af4e9d5c2526280fcdd0327946b5a303d" title="To add a given set of ports and VLAN to spanning tree instance.">example_stg_create</a>(<span class="keywordtype">int</span> unit, <a class="code" href="structstg__info__s.html">stg_info_s</a> *info) {
<a name="l00289"></a>00289   <span class="keywordtype">int</span> rv;
<a name="l00290"></a>00290   <a class="code" href="struct__shr__pbmp.html">opennsl_pbmp_t</a> pbmp;
<a name="l00291"></a>00291 
<a name="l00292"></a>00292   <span class="comment">/* create VLAN */</span>
<a name="l00293"></a>00293   rv = <a class="code" href="group__vlan.html#ga4db9e633ba9c276064768d1718c3062c" title="Allocate and configure a VLAN on the OPENNSL device.">opennsl_vlan_create</a>(<a class="code" href="example__stp_8c.html#adbb76aecfc5eef000cb4cb55bc2fd404">DEFAULT_UNIT</a>, info-&gt;<a class="code" href="structstg__info__s.html#a8ce9eaa586377944527b3a36d1193e63">vlan_1</a>);
<a name="l00294"></a>00294   <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {
<a name="l00295"></a>00295     printf(<span class="stringliteral">&quot;Error, in opennsl_vlan_create, vid=%d, \n&quot;</span>, info-&gt;<a class="code" href="structstg__info__s.html#a8ce9eaa586377944527b3a36d1193e63">vlan_1</a>);
<a name="l00296"></a>00296     <span class="keywordflow">return</span> rv;
<a name="l00297"></a>00297   }
<a name="l00298"></a>00298 
<a name="l00299"></a>00299   <span class="keywordflow">if</span>(<a class="code" href="example__routing_8c.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a> &gt;= 2) {
<a name="l00300"></a>00300     printf(<span class="stringliteral">&quot;VLAN %d is created.\n&quot;</span>, info-&gt;<a class="code" href="structstg__info__s.html#a8ce9eaa586377944527b3a36d1193e63">vlan_1</a>);
<a name="l00301"></a>00301   }
<a name="l00302"></a>00302 
<a name="l00303"></a>00303   <a class="code" href="group__types.html#gafe134087fe1330ec8fffbe7685f139b8">OPENNSL_PBMP_CLEAR</a>(pbmp);
<a name="l00304"></a>00304   <a class="code" href="group__types.html#ga7a3934e09536bcaabfdf0f5aefc48411">OPENNSL_PBMP_PORT_ADD</a>(pbmp, info-&gt;<a class="code" href="structstg__info__s.html#a6cc6a444e17b7a95da3b47b901999ac0">port_1</a>);
<a name="l00305"></a>00305   <a class="code" href="group__types.html#ga7a3934e09536bcaabfdf0f5aefc48411">OPENNSL_PBMP_PORT_ADD</a>(pbmp, info-&gt;<a class="code" href="structstg__info__s.html#addd1bd50cfb8cee2b63c34cbf4ef3582">port_2</a>);
<a name="l00306"></a>00306 
<a name="l00307"></a>00307   rv = <a class="code" href="group__vlan.html#ga1e7cecaf6718cd174f1b1aef29349340" title="Add ports to the specified VLAN.">opennsl_vlan_port_add</a>(unit, info-&gt;<a class="code" href="structstg__info__s.html#a8ce9eaa586377944527b3a36d1193e63">vlan_1</a>, pbmp, pbmp);
<a name="l00308"></a>00308   <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {
<a name="l00309"></a>00309     printf(<span class="stringliteral">&quot;OPENNSL FAIL %d: %s\n&quot;</span>, rv, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));
<a name="l00310"></a>00310     <span class="keywordflow">return</span> rv;
<a name="l00311"></a>00311   }
<a name="l00312"></a>00312 
<a name="l00313"></a>00313   <span class="keywordflow">if</span>(<a class="code" href="example__routing_8c.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a> &gt;= 2) {
<a name="l00314"></a>00314     printf(<span class="stringliteral">&quot;Added ports %d, %d to VLAN %d.\n&quot;</span>,
<a name="l00315"></a>00315            info-&gt;<a class="code" href="structstg__info__s.html#a6cc6a444e17b7a95da3b47b901999ac0">port_1</a>, info-&gt;<a class="code" href="structstg__info__s.html#addd1bd50cfb8cee2b63c34cbf4ef3582">port_2</a>, info-&gt;<a class="code" href="structstg__info__s.html#a8ce9eaa586377944527b3a36d1193e63">vlan_1</a>);
<a name="l00316"></a>00316   }
<a name="l00317"></a>00317 
<a name="l00318"></a>00318   <span class="comment">/* add the vlans to the stg */</span>
<a name="l00319"></a>00319   rv = <a class="code" href="group__stg.html#ga7a9bcd2314c8a2dd1d9de9f362ab0f42" title="Add a VLAN to a specified STG.">opennsl_stg_vlan_add</a>(unit, info-&gt;<a class="code" href="structstg__info__s.html#a9e2acb72995a5779237c8b66f3904a53">stg</a>, info-&gt;<a class="code" href="structstg__info__s.html#a8ce9eaa586377944527b3a36d1193e63">vlan_1</a>);
<a name="l00320"></a>00320   <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {
<a name="l00321"></a>00321     printf(<span class="stringliteral">&quot;Error, in opennsl_stg_vlan_add, vid=%d, \n&quot;</span>, info-&gt;<a class="code" href="structstg__info__s.html#a8ce9eaa586377944527b3a36d1193e63">vlan_1</a>);
<a name="l00322"></a>00322     <span class="keywordflow">return</span> rv;
<a name="l00323"></a>00323   }
<a name="l00324"></a>00324 
<a name="l00325"></a>00325   <span class="keywordflow">if</span>(<a class="code" href="example__routing_8c.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a> &gt;= 2) {
<a name="l00326"></a>00326     printf(<span class="stringliteral">&quot;Attached VLAN %d to Spanning Tree Group %d.\n&quot;</span>,
<a name="l00327"></a>00327            info-&gt;<a class="code" href="structstg__info__s.html#a8ce9eaa586377944527b3a36d1193e63">vlan_1</a>, info-&gt;<a class="code" href="structstg__info__s.html#a9e2acb72995a5779237c8b66f3904a53">stg</a>);
<a name="l00328"></a>00328   }
<a name="l00329"></a>00329 
<a name="l00330"></a>00330   <span class="comment">/* add two ports to the stg and attach stp state for each of them */</span>
<a name="l00331"></a>00331   rv = <a class="code" href="group__stg.html#gac4824e77e2d0cd577a9962d63e5b53ac" title="Set the Spanning Tree Protocol state of a port in the specified STG.">opennsl_stg_stp_set</a>(unit, info-&gt;<a class="code" href="structstg__info__s.html#a9e2acb72995a5779237c8b66f3904a53">stg</a>, info-&gt;<a class="code" href="structstg__info__s.html#a6cc6a444e17b7a95da3b47b901999ac0">port_1</a>, info-&gt;<a class="code" href="structstg__info__s.html#a732dc92a708481c8aa6266d71771c7da">stp_state_1</a>);
<a name="l00332"></a>00332   <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {
<a name="l00333"></a>00333     printf(<span class="stringliteral">&quot;Error, in opennsl_stg_stp_set, stg=%d, \n&quot;</span>, info-&gt;<a class="code" href="structstg__info__s.html#a9e2acb72995a5779237c8b66f3904a53">stg</a>);
<a name="l00334"></a>00334     <span class="keywordflow">return</span> rv;
<a name="l00335"></a>00335   }
<a name="l00336"></a>00336 
<a name="l00337"></a>00337   <span class="keywordflow">if</span>(<a class="code" href="example__routing_8c.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a> &gt;= 2) {
<a name="l00338"></a>00338     printf(<span class="stringliteral">&quot;STP state of port %d is set to \&quot;%s\&quot;.\n&quot;</span>, 
<a name="l00339"></a>00339            info-&gt;<a class="code" href="structstg__info__s.html#a6cc6a444e17b7a95da3b47b901999ac0">port_1</a>, <a class="code" href="example__stp_8c.html#ae0e347ac4536e36380f2a6b66bed71f4">stp_state_str</a>[info-&gt;<a class="code" href="structstg__info__s.html#a732dc92a708481c8aa6266d71771c7da">stp_state_1</a>]);
<a name="l00340"></a>00340   }
<a name="l00341"></a>00341 
<a name="l00342"></a>00342   rv = <a class="code" href="group__stg.html#gac4824e77e2d0cd577a9962d63e5b53ac" title="Set the Spanning Tree Protocol state of a port in the specified STG.">opennsl_stg_stp_set</a>(unit, info-&gt;<a class="code" href="structstg__info__s.html#a9e2acb72995a5779237c8b66f3904a53">stg</a>, info-&gt;<a class="code" href="structstg__info__s.html#addd1bd50cfb8cee2b63c34cbf4ef3582">port_2</a>, info-&gt;<a class="code" href="structstg__info__s.html#a5bf712990d2edd0345bbdb18a0e58044">stp_state_2</a>);
<a name="l00343"></a>00343   <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {
<a name="l00344"></a>00344     printf(<span class="stringliteral">&quot;Error, in opennsl_stg_stp_set, stg=%d, \n&quot;</span>, info-&gt;<a class="code" href="structstg__info__s.html#a9e2acb72995a5779237c8b66f3904a53">stg</a>);
<a name="l00345"></a>00345     <span class="keywordflow">return</span> rv;
<a name="l00346"></a>00346   }
<a name="l00347"></a>00347   <span class="keywordflow">if</span>(<a class="code" href="example__routing_8c.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a> &gt;= 2) {
<a name="l00348"></a>00348     printf(<span class="stringliteral">&quot;STP state of port %d is set to \&quot;%s\&quot;.\n&quot;</span>,
<a name="l00349"></a>00349            info-&gt;<a class="code" href="structstg__info__s.html#addd1bd50cfb8cee2b63c34cbf4ef3582">port_2</a>, <a class="code" href="example__stp_8c.html#ae0e347ac4536e36380f2a6b66bed71f4">stp_state_str</a>[info-&gt;<a class="code" href="structstg__info__s.html#a5bf712990d2edd0345bbdb18a0e58044">stp_state_2</a>]);
<a name="l00350"></a>00350   }
<a name="l00351"></a>00351 
<a name="l00352"></a>00352   <span class="keywordflow">return</span> <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>;
<a name="l00353"></a>00353 }
<a name="l00354"></a>00354 <span class="comment">/* __doxy_func_body_end__ */</span>
<a name="l00355"></a>00355 
<a name="l00356"></a>00356 <span class="comment">/**************************************************************************/</span>
<a name="l00365"></a><a class="code" href="example__stp_8c.html#afdd1bc23e6d6ae6ca5ce66a9adff1657">00365</a> <span class="keywordtype">int</span> <a class="code" href="example__stp_8c.html#afdd1bc23e6d6ae6ca5ce66a9adff1657" title="To destroy the spanning tree instance and VLAN&#39;s associate with it.">revert_stg</a>(<span class="keywordtype">int</span> unit, <a class="code" href="structstg__info__s.html">stg_info_s</a> *info) {
<a name="l00366"></a>00366   <span class="keywordtype">int</span> rv = <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>;
<a name="l00367"></a>00367 
<a name="l00368"></a>00368   rv = <a class="code" href="group__stg.html#gae640e96550b5bf103f4deb6fcc07758b" title="Destroys the specified STG.">opennsl_stg_destroy</a>(unit,info-&gt;<a class="code" href="structstg__info__s.html#a9e2acb72995a5779237c8b66f3904a53">stg</a>);
<a name="l00369"></a>00369   <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {
<a name="l00370"></a>00370     printf(<span class="stringliteral">&quot;Error, in opennsl_stg_destroy\n&quot;</span>);
<a name="l00371"></a>00371     <span class="keywordflow">return</span> rv;
<a name="l00372"></a>00372   }
<a name="l00373"></a>00373 
<a name="l00374"></a>00374   rv = <a class="code" href="group__vlan.html#ga4cc66dc56e5ca8e4d7c309ab8ad8f5f8" title="Deallocate VLAN from the OPENNSL device.">opennsl_vlan_destroy</a>(unit,info-&gt;<a class="code" href="structstg__info__s.html#a8ce9eaa586377944527b3a36d1193e63">vlan_1</a>);
<a name="l00375"></a>00375   <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {
<a name="l00376"></a>00376     printf(<span class="stringliteral">&quot;Error, in opennsl_vlan_destroy, vid=%d, \n&quot;</span>, info-&gt;<a class="code" href="structstg__info__s.html#a8ce9eaa586377944527b3a36d1193e63">vlan_1</a>);
<a name="l00377"></a>00377     <span class="keywordflow">return</span> rv;
<a name="l00378"></a>00378   }
<a name="l00379"></a>00379 
<a name="l00380"></a>00380   <span class="keywordflow">return</span> rv;
<a name="l00381"></a>00381 }
<a name="l00382"></a>00382 <span class="comment">/* __doxy_func_body_end__ */</span>
</pre></div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.5-->
<!-- start footer part -->


<!--BEGIN GENERATE_TREEVIEW -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->

<hr>
<p>	
<table class="footer-brcm">
	<tr>
		<td class="footer-brcm"><img src="BRCM_Red+Black_noTag_RGB.png" align=left></td>
		<td class="footer-brcm"><small><b>&copy;  2015 by Broadcom Corporation. All rights reserved.</b></small>
			<div class="footer-brcm"><small>Broadcom Corporation reserves the right to make changes without further notice to any products or data herein to improve reliability, function, or design. 
Information furnished by Broadcom Corporation is believed to be accurate and reliable. However, Broadcom Corporation does not assume any liability arising 
out of the application or use of this information, nor the application or use of any product or circuit described herein, neither does it convey any license 
under its patent rights nor the rights of others. </small>
			</div>
		</td>
	</tr>
</table>	
</p>	
	

</div>

<!--END GENERATE_TREEVIEW-->





</body>
</html>
